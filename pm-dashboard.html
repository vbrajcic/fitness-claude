<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fitness Anny - Product Management Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f4f5f7;
            min-height: 100vh;
            color: #172b4d;
            margin: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: #ffffff;
            color: #172b4d;
            padding: 24px 32px;
            border-radius: 3px;
            margin-bottom: 24px;
            box-shadow: 0 1px 2px rgba(9, 30, 66, 0.25);
            border-left: 4px solid #0052cc;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-content {
            flex: 1;
        }

        .nav-button {
            background: #0052cc;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background-color 0.2s ease;
            text-decoration: none;
            display: inline-block;
        }

        .nav-button:hover {
            background: #0747a6;
        }

        .header h1 {
            font-size: 1.7rem;
            margin-bottom: 8px;
            font-weight: 600;
            color: #172b4d;
        }

        .header p {
            font-size: 1rem;
            color: #5e6c84;
            margin-bottom: 16px;
        }

        .sync-status {
            background: #f4f5f7;
            padding: 8px 12px;
            border-radius: 3px;
            margin-top: 16px;
            font-size: 0.85rem;
            color: #5e6c84;
            border: 1px solid #dfe1e6;
        }

        .lifecycle-header {
            text-align: center;
            margin: 32px 0 24px 0;
            padding: 24px;
            background: #ffffff;
            border-radius: 3px;
            box-shadow: 0 1px 2px rgba(9, 30, 66, 0.25);
            border: 1px solid #dfe1e6;
        }

        .lifecycle-header h2 {
            color: #172b4d;
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .lifecycle-header p {
            color: #5e6c84;
            font-size: 0.9rem;
            margin: 0;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }

        .section {
            background: #ffffff;
            border-radius: 3px;
            padding: 0;
            box-shadow: 0 1px 2px rgba(9, 30, 66, 0.25);
            margin-bottom: 24px;
            border: 1px solid #dfe1e6;
        }

        .section-header {
            display: flex;
            align-items: flex-start;
            padding: 16px 24px;
            border-bottom: 1px solid #dfe1e6;
            background: #f4f5f7;
        }

        .section-text {
            flex: 1;
            margin-left: 8px;
        }

        .section-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            margin-right: 8px;
            color: #5e6c84;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #172b4d;
            margin-bottom: 4px;
        }

        .section-subtitle {
            font-size: 0.8rem;
            color: #5e6c84;
            font-style: italic;
            margin-right: auto;
        }

        .section-count {
            margin-left: auto;
            background: #dfe1e6;
            color: #5e6c84;
            padding: 2px 8px;
            border-radius: 2px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Stage-specific styling */
        .stage-ideas {
            border-left: 4px solid #ff8b00;
        }

        .stage-ideas .section-header {
            background: #fffae6;
        }

        .stage-features {
            border-left: 4px solid #0052cc;
        }

        .stage-features .section-header {
            background: #e6f3ff;
        }

        .stage-backlog {
            border-left: 4px solid #006644;
        }

        .stage-backlog .section-header {
            background: #e3fcef;
        }

        .stage-bugs {
            border-left: 4px solid #bf2600;
        }

        .stage-bugs .section-header {
            background: #ffebe6;
        }


        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            justify-content: flex-end;
        }

        .action-btn {
            background: #0052cc;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background-color 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .action-btn:hover {
            background: #0747a6;
        }

        .action-btn.secondary {
            background: #f4f5f7;
            color: #172b4d;
            border: 1px solid #dfe1e6;
        }

        .action-btn.secondary:hover {
            background: #ebecf0;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(9, 30, 66, 0.54);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 3px;
            box-shadow: 0 10px 50px rgba(9, 30, 66, 0.15);
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 24px 24px 16px 24px;
            border-bottom: 1px solid #dfe1e6;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #172b4d;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #5e6c84;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            color: #172b4d;
        }

        .modal-body {
            padding: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: #172b4d;
            margin-bottom: 6px;
            font-size: 0.9rem;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #dfe1e6;
            border-radius: 3px;
            font-size: 0.9rem;
            color: #172b4d;
            background: white;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #0052cc;
            box-shadow: 0 0 0 2px rgba(0, 82, 204, 0.2);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid #dfe1e6;
        }

        .priority-selector {
            display: flex;
            gap: 8px;
            margin-top: 6px;
        }

        .priority-option {
            padding: 6px 12px;
            border: 1px solid #dfe1e6;
            border-radius: 3px;
            background: #f4f5f7;
            color: #5e6c84;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .priority-option.selected {
            border-color: #0052cc;
            background: #0052cc;
            color: white;
        }

        .priority-option.high {
            border-color: #bf2600;
            color: #bf2600;
        }

        .priority-option.high.selected {
            background: #bf2600;
            color: white;
        }

        .priority-option.medium {
            border-color: #ff8b00;
            color: #ff8b00;
        }

        .priority-option.medium.selected {
            background: #ff8b00;
            color: white;
        }

        .priority-option.low {
            border-color: #006644;
            color: #006644;
        }

        .priority-option.low.selected {
            background: #006644;
            color: white;
        }

        @media (max-width: 768px) {
            .action-buttons {
                flex-direction: column;
            }

            .modal-content {
                margin: 20px;
                width: calc(100% - 40px);
            }

            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
        }

        .loading {
            text-align: center;
            padding: 32px 24px;
            color: #5e6c84;
            font-size: 0.9rem;
        }

        .spinner {
            border: 2px solid #dfe1e6;
            border-top: 2px solid #0052cc;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            margin: 0 auto 12px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .item {
            background: white;
            border: 1px solid #dfe1e6;
            border-radius: 3px;
            margin-bottom: 8px;
            padding: 16px;
            transition: all 0.2s ease;
            cursor: pointer;
            box-shadow: 0 1px 2px rgba(9, 30, 66, 0.04);
        }

        .item:hover {
            box-shadow: 0 2px 4px rgba(9, 30, 66, 0.08);
            border-color: #b3bac5;
            background: #f8f9fa;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .item-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #172b4d;
            line-height: 1.3;
            flex: 1;
            margin-right: 12px;
        }

        .item-priority {
            font-size: 0.75rem;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 2px;
            text-transform: uppercase;
            white-space: nowrap;
        }

        .item-priority.critical {
            background: #de350b;
            color: white;
        }

        .item-priority.high {
            background: #ffebe6;
            color: #bf2600;
        }

        .item-priority.medium {
            background: #fff0b3;
            color: #974f0c;
        }

        .item-priority.low {
            background: #e3fcef;
            color: #006644;
        }

        .item-summary {
            color: #5e6c84;
            line-height: 1.4;
            font-size: 0.85rem;
            margin-bottom: 12px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .item-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .item-platform {
            font-size: 0.75rem;
            color: #5e6c84;
            font-weight: 500;
            background: #f4f5f7;
            padding: 2px 6px;
            border-radius: 2px;
        }

        .item-id {
            font-size: 0.75rem;
            color: #8993a4;
            font-family: monospace;
        }

        /* Modal Styles - Jira Inspired */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(9, 30, 66, 0.54);
            z-index: 1000;
            justify-content: center;
            align-items: flex-start;
            padding: 40px 20px;
            overflow-y: auto;
            box-sizing: border-box;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 3px;
            box-shadow: 0 10px 50px rgba(9, 30, 66, 0.15);
            width: 100%;
            max-width: 1200px;
            max-height: calc(100vh - 60px);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .modal-header {
            padding: 20px 24px 16px 24px;
            border-bottom: 1px solid #dfe1e6;
            background: #f4f5f7;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .modal-header-left {
            flex: 1;
        }

        .modal-issue-id {
            font-size: 0.8rem;
            color: #5e6c84;
            font-family: monospace;
            margin-bottom: 8px;
        }

        .modal-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #172b4d;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .modal-meta {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .modal-priority {
            font-size: 0.75rem;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 2px;
            text-transform: uppercase;
        }

        .modal-priority.critical {
            background: #de350b;
            color: white;
        }

        .modal-priority.high {
            background: #ffebe6;
            color: #bf2600;
        }

        .modal-priority.medium {
            background: #fff0b3;
            color: #974f0c;
        }

        .modal-priority.low {
            background: #e3fcef;
            color: #006644;
        }

        .modal-platform {
            font-size: 0.8rem;
            color: #5e6c84;
            background: white;
            padding: 4px 8px;
            border-radius: 2px;
            border: 1px solid #dfe1e6;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #5e6c84;
            cursor: pointer;
            padding: 4px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 2px;
        }

        .close-btn:hover {
            background: #ebecf0;
            color: #172b4d;
        }

        .modal-body {
            padding: 0;
            overflow-y: auto;
            flex: 1;
            background: #f4f5f7;
        }

        .modal-content-wrapper {
            padding: 20px 24px 24px 24px;
        }

        .modal-section {
            background: white;
            border-radius: 3px;
            margin-bottom: 16px;
            border: 1px solid #dfe1e6;
        }

        /* Jira-style layout */
        .jira-header {
            background: #f4f5f7;
            padding: 16px;
            border-radius: 3px;
            margin-bottom: 20px;
        }

        .jira-metrics {
            display: flex;
            gap: 24px;
        }

        .metric {
            text-align: center;
        }

        .metric-number {
            display: block;
            font-size: 24px;
            font-weight: bold;
            color: #0052cc;
        }

        .jira-section {
            margin-bottom: 24px;
        }

        .jira-section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #172b4d;
            border-bottom: 1px solid #dfe1e6;
            padding-bottom: 8px;
        }

        .jira-content {
            background: white;
            border-radius: 3px;
            padding: 16px;
            border: 1px solid #dfe1e6;
        }

        .epic-container {
            border: 1px solid #0052cc;
            border-radius: 3px;
            margin-bottom: 16px;
            background: #f4f5f7;
        }

        .epic-header {
            background: #0052cc;
            color: white;
            padding: 12px 16px;
            border-radius: 3px 3px 0 0;
        }

        .epic-title {
            font-size: 14px;
            font-weight: 600;
            margin: 0;
        }

        .epic-meta {
            font-size: 12px;
            opacity: 0.9;
            margin-top: 4px;
        }

        .stories-container {
            padding: 12px;
        }

        .story-card {
            background: white;
            border: 1px solid #dfe1e6;
            border-radius: 3px;
            margin-bottom: 12px;
            padding: 12px;
        }

        .story-header {
            margin-bottom: 8px;
        }

        .story-title {
            font-size: 14px;
            font-weight: 600;
            margin: 0;
            color: #172b4d;
        }

        .story-description {
            margin-bottom: 12px;
            color: #5e6c84;
            font-style: italic;
        }

        .acceptance-criteria {
            margin-top: 12px;
        }

        .criteria-list {
            list-style: none;
            padding: 0;
            margin: 8px 0 0 0;
        }

        .criteria-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 13px;
        }

        .criteria-checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid #dfe1e6;
            border-radius: 2px;
            flex-shrink: 0;
            margin-top: 1px;
        }

        .criteria-checkbox.checked {
            background: #36b37e;
            border-color: #36b37e;
            position: relative;
        }

        .criteria-checkbox.checked:after {
            content: '✓';
            color: white;
            font-size: 12px;
            position: absolute;
            top: -1px;
            left: 2px;
        }

        .criteria-item.completed {
            opacity: 0.7;
            text-decoration: line-through;
        }

        .tickets-container {
            padding: 12px;
            border-top: 1px solid #dfe1e6;
        }

        .tickets-container h6 {
            margin: 0 0 8px 0;
            font-size: 12px;
            font-weight: 600;
            color: #5e6c84;
        }

        .tickets-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .ticket-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 0;
            border-bottom: 1px solid #f4f5f7;
            font-size: 13px;
        }

        .ticket-checkbox {
            width: 14px;
            height: 14px;
            border: 1px solid #dfe1e6;
            border-radius: 2px;
            flex-shrink: 0;
        }

        .ticket-checkbox.checked {
            background: #36b37e;
            border-color: #36b37e;
        }

        .spike-container {
            border: 1px solid #ff8b00;
            border-radius: 3px;
            margin-bottom: 16px;
            background: #fffae6;
        }

        .spike-title {
            background: #ff8b00;
            color: white;
            padding: 8px 12px;
            margin: 0;
            font-size: 14px;
            font-weight: 600;
            border-radius: 3px 3px 0 0;
        }

        .spike-content {
            padding: 12px;
            background: white;
            border-radius: 0 0 3px 3px;
        }

        .phase-container {
            border: 1px solid #6554c0;
            border-radius: 3px;
            margin-bottom: 16px;
            background: #f4f3ff;
        }

        .phase-title {
            background: #6554c0;
            color: white;
            padding: 8px 12px;
            margin: 0;
            font-size: 14px;
            font-weight: 600;
            border-radius: 3px 3px 0 0;
        }

        .phase-tasks {
            list-style: none;
            padding: 12px;
            margin: 0;
            background: white;
            border-radius: 0 0 3px 3px;
        }

        .task-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .task-checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid #dfe1e6;
            border-radius: 2px;
            flex-shrink: 0;
            margin-top: 1px;
        }

        .task-checkbox.checked {
            background: #36b37e;
            border-color: #36b37e;
        }

        .task-item.completed {
            opacity: 0.7;
            text-decoration: line-through;
        }

        .modal-section-header {
            padding: 12px 16px;
            background: #f4f5f7;
            border-bottom: 1px solid #dfe1e6;
            font-weight: 600;
            font-size: 0.9rem;
            color: #172b4d;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-section-content {
            padding: 16px;
        }

        .user-story-card {
            background: #f8f9fa;
            border: 1px solid #dfe1e6;
            border-radius: 3px;
            margin-bottom: 12px;
            overflow: hidden;
            border-left: 4px solid #0052cc;
        }

        .user-story-header {
            padding: 12px 16px;
            background: #e6f3ff;
            border-bottom: 1px solid #dfe1e6;
            font-weight: 600;
            color: #0052cc;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .user-story-header::before {
            content: '👤';
            margin-right: 8px;
        }

        .user-story-content {
            padding: 12px 16px;
        }

        .user-story-text {
            font-style: italic;
            color: #5e6c84;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }

        .acceptance-criteria {
            margin-top: 12px;
        }

        .acceptance-criteria h4 {
            font-size: 0.8rem;
            font-weight: 600;
            color: #172b4d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .criteria-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .criteria-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 6px;
            font-size: 0.85rem;
            color: #172b4d;
        }

        .criteria-checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid #dfe1e6;
            border-radius: 2px;
            margin-right: 8px;
            margin-top: 1px;
            flex-shrink: 0;
            position: relative;
        }

        .criteria-checkbox.completed {
            background: #36b37e;
            border-color: #36b37e;
        }

        .criteria-checkbox.completed::after {
            content: '✓';
            color: white;
            font-size: 10px;
            position: absolute;
            top: 0px;
            left: 2px;
        }

        .phase-section {
            margin-bottom: 24px;
        }

        .phase-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            background: #172b4d;
            color: white;
            border-radius: 6px;
            margin-bottom: 16px;
            box-shadow: 0 2px 4px rgba(9, 30, 66, 0.15);
        }

        .phase-title {
            font-weight: 700;
            color: white;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .phase-title::before {
            content: '📦';
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .phase-progress {
            font-size: 0.85rem;
            color: #b3d4fc;
            background: rgba(255, 255, 255, 0.1);
            padding: 4px 8px;
            border-radius: 3px;
        }

        .task-list {
            background: white;
            border: 1px solid #dfe1e6;
            border-radius: 3px;
            padding: 12px;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 6px 0;
            border-bottom: 1px solid #f4f5f7;
            font-size: 0.85rem;
        }

        .task-item:last-child {
            border-bottom: none;
        }

        .task-checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid #dfe1e6;
            border-radius: 2px;
            margin-right: 8px;
            flex-shrink: 0;
            position: relative;
            background: white;
        }

        .task-checkbox.completed {
            background: #36b37e;
            border-color: #36b37e;
        }

        .task-checkbox.completed::after {
            content: '✓';
            color: white;
            font-size: 11px;
            font-weight: bold;
            position: absolute;
            top: 0px;
            left: 2px;
            line-height: 1;
        }

        .count-badge {
            background: #dfe1e6;
            color: #5e6c84;
            padding: 2px 6px;
            border-radius: 2px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .count-badge.stories {
            background: #e6f3ff;
            color: #0052cc;
        }

        .count-badge.tasks {
            background: #fff0b3;
            color: #974f0c;
        }

        .summary-stats {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            padding: 12px 16px;
            background: #f8f9fa;
            border-radius: 3px;
            border: 1px solid #dfe1e6;
        }

        .stat-item {
            text-align: center;
            flex: 1;
        }

        .stat-number {
            font-size: 1.2rem;
            font-weight: 600;
            color: #172b4d;
            display: block;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #5e6c84;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tickets-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .ticket-card {
            background: white;
            border: 1px solid #dfe1e6;
            border-radius: 3px;
            overflow: hidden;
        }

        .ticket-header {
            padding: 12px 16px;
            background: white;
            border-bottom: 1px solid #f4f5f7;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ticket-status {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ticket-badges {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .ticket-content {
            padding: 16px;
        }

        .ticket-section {
            margin-bottom: 16px;
        }

        .ticket-section:last-child {
            margin-bottom: 0;
        }

        .ticket-section-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: #5e6c84;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .ticket-section-content {
            color: #172b4d;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .ticket-section-content.user-story-text {
            font-style: italic;
            color: #0052cc;
            background: #e6f3ff;
            padding: 8px 12px;
            border-radius: 3px;
            border-left: 3px solid #0052cc;
        }

        .modal-field {
            margin-bottom: 16px;
        }

        .modal-field:last-child {
            margin-bottom: 0;
        }

        .field-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: #5e6c84;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .field-content {
            color: #172b4d;
            line-height: 1.5;
            font-size: 0.9rem;
        }

        .field-content.user-story {
            background: #f4f5f7;
            padding: 12px;
            border-radius: 3px;
            border-left: 3px solid #0052cc;
            font-style: italic;
        }

        .field-chips {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .modal-chip {
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .modal-chip.impact-high {
            background: #ffebe6;
            color: #bf2600;
        }

        .modal-chip.impact-medium {
            background: #fff0b3;
            color: #974f0c;
        }

        .modal-chip.impact-low {
            background: #e3fcef;
            color: #006644;
        }

        .modal-chip.effort-high {
            background: #eae6ff;
            color: #5243aa;
        }

        .modal-chip.effort-medium {
            background: #f0f0f0;
            color: #42526e;
        }

        .modal-chip.effort-low {
            background: #e3fcef;
            color: #006644;
        }

        .modal-chip.complexity {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .modal-chip.story-points {
            background: #e3f2fd;
            color: #1976d2;
        }

        .acceptance-list {
            margin: 0;
            padding-left: 16px;
        }

        .acceptance-list li {
            margin-bottom: 6px;
            color: #172b4d;
        }

        .modal-divider {
            height: 1px;
            background: #dfe1e6;
            margin: 16px 0;
        }

        .modal-description h3,
        .modal-description h4 {
            color: #172b4d;
            margin: 16px 0 8px 0;
            font-weight: 600;
        }

        .modal-description strong {
            font-weight: 600;
            color: #172b4d;
        }

        .modal-description ul,
        .modal-description ol {
            margin: 8px 0 8px 20px;
        }

        .modal-description li {
            margin-bottom: 4px;
        }

        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .tag {
            background: #dfe1e6;
            color: #5e6c84;
            padding: 2px 6px;
            border-radius: 2px;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .tag.priority-high { 
            background: #ffebe6; 
            color: #bf2600; 
        }
        .tag.priority-medium { 
            background: #fffae6; 
            color: #ff8b00; 
        }
        .tag.priority-low { 
            background: #e3fcef; 
            color: #006644; 
        }
        .tag.platform-mobile { 
            background: #eae6ff; 
            color: #5243aa; 
        }
        .tag.platform-admin { 
            background: #f4f5f7; 
            color: #172b4d; 
        }
        .tag.platform-web { 
            background: #e6fcff; 
            color: #0052cc; 
        }

        .filters {
            background: #ffffff;
            padding: 16px 24px;
            border-radius: 3px;
            margin-bottom: 24px;
            box-shadow: 0 1px 2px rgba(9, 30, 66, 0.25);
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
            border: 1px solid #dfe1e6;
        }

        .filter-btn {
            background: #f4f5f7;
            border: 1px solid #dfe1e6;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            font-size: 0.85rem;
            color: #5e6c84;
        }

        .filter-btn.active {
            background: #0052cc;
            color: white;
            border-color: #0052cc;
        }

        .filter-btn:hover:not(.active) {
            background: #ebecf0;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 8px 12px;
            border: 1px solid #dfe1e6;
            border-radius: 3px;
            font-size: 0.9rem;
            color: #172b4d;
        }

        .search-box:focus {
            outline: none;
            border-color: #0052cc;
            box-shadow: 0 0 0 2px rgba(0, 82, 204, 0.2);
        }

        .error {
            background: #ffebe6;
            color: #bf2600;
            padding: 16px 24px;
            border-radius: 3px;
            border: 1px solid #ffbdad;
            margin: 16px 0;
            font-size: 0.9rem;
        }

        .empty-state {
            text-align: center;
            padding: 32px 24px;
            color: #5e6c84;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 12px;
            opacity: 0.6;
        }

        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }
            
            .filters {
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
            }
            
            .filter-btn {
                text-align: center;
            }
            
            .search-box {
                min-width: auto;
                margin-top: 8px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }

            .header {
                padding: 16px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>🏋️‍♀️ Fitness Anny</h1>
                <p>Product Management Dashboard</p>
                <div class="sync-status" id="syncStatus">
                    <span id="lastSync">Last sync: Loading...</span> | 
                    <span id="repoStatus">Repository: vbrajcic/fitness-claude</span>
                </div>
            </div>
            <a href="prds.html" class="nav-button">📋 View PRDs</a>
        </div>

        <div class="filters">
            <div style="font-weight: 600; color: #172b4d; margin-right: 12px; font-size: 0.9rem;">Platform:</div>
            <button class="filter-btn active" data-filter="all">All Platforms</button>
            <button class="filter-btn" data-filter="mobile">Mobile App</button>
            <button class="filter-btn" data-filter="admin">Admin Panel</button>
            <button class="filter-btn" data-filter="web">Website</button>
            <input type="text" class="search-box" placeholder="Search across all stages..." id="searchBox">
        </div>

        <div class="lifecycle-header">
            <h2>Product Development Lifecycle</h2>
            <p>Track items through different stages of refinement and readiness</p>
        </div>

        <div class="action-buttons">
            <button class="action-btn secondary" onclick="openReportModal('idea')">
                💡 Report Idea
            </button>
            <button class="action-btn secondary" onclick="openReportModal('bug')">
                🐛 Report Bug
            </button>
        </div>

        <div class="dashboard-grid">
            <!-- Ideas Stage -->
            <div class="section stage-ideas" id="ideasSection">
                <div class="section-header">
                    <div class="section-icon">💡</div>
                    <div class="section-text">
                        <div class="section-title">Ideas</div>
                        <div class="section-subtitle">Raw concepts needing validation</div>
                    </div>
                    <div class="section-count" id="ideasCount">-</div>
                </div>
                <div id="ideaItems" class="loading">
                    <div class="spinner"></div>
                    <div>Loading ideas...</div>
                </div>
            </div>

            <!-- Features Stage -->
            <div class="section stage-features" id="featuresSection">
                <div class="section-header">
                    <div class="section-icon">⚡</div>
                    <div class="section-text">
                        <div class="section-title">Features</div>
                        <div class="section-subtitle">Approved concepts being refined</div>
                    </div>
                    <div class="section-count" id="featuresCount">-</div>
                </div>
                <div id="featureItems" class="loading">
                    <div class="spinner"></div>
                    <div>Loading features...</div>
                </div>
            </div>


            <!-- Bugs Section -->
            <div class="section stage-bugs" id="bugsSection">
                <div class="section-header">
                    <div class="section-icon">🐛</div>
                    <div class="section-text">
                        <div class="section-title">Bugs & Issues</div>
                        <div class="section-subtitle">Problems requiring investigation</div>
                    </div>
                    <div class="section-count" id="bugsCount">-</div>
                </div>
                <div id="bugItems" class="loading">
                    <div class="spinner"></div>
                    <div>Loading bugs...</div>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal for item details -->
    <div class="modal" id="itemModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-left">
                    <div class="modal-issue-id" id="modalIssueId">#ID</div>
                    <h2 class="modal-title" id="modalTitle">Item Title</h2>
                    <div class="modal-meta">
                        <span class="modal-priority" id="modalPriority">Priority</span>
                        <span class="modal-platform" id="modalPlatform">Platform</span>
                    </div>
                </div>
                <button class="close-btn" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="modal-content-wrapper" id="modalContent">
                    <!-- Content will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        class PMDashboard {
            constructor() {
                this.repoOwner = 'vbrajcic'; // Update with your GitHub username
                this.repoName = 'fitness-claude'; // Update with your repo name
                this.branch = 'main';
                this.apiBase = `https://api.github.com/repos/${this.repoOwner}/${this.repoName}`;
                this.rawBase = `https://raw.githubusercontent.com/${this.repoOwner}/${this.repoName}/${this.branch}`;
                
                // Detect if running locally vs GitHub Pages
                this.isLocal = this.detectLocalEnvironment();
                
                this.allItems = [];
                this.filteredItems = [];
                this.currentFilter = 'all';
                
                this.init();
            }

            detectLocalEnvironment() {
                const hostname = window.location.hostname;
                const protocol = window.location.protocol;
                
                // Local indicators: file://, localhost, 127.0.0.1, or local IP
                return protocol === 'file:' || 
                       hostname === 'localhost' || 
                       hostname === '127.0.0.1' ||
                       hostname.startsWith('192.168.') ||
                       hostname.startsWith('10.') ||
                       hostname.includes('.local');
            }

            async init() {
                this.setupEventListeners();
                await this.loadData();
                this.updateSyncStatus();
                
                // Auto-refresh every 5 minutes
                setInterval(() => this.loadData(), 5 * 60 * 1000);
            }

            setupEventListeners() {
                // Filter buttons
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.currentFilter = e.target.dataset.filter;
                        this.filterAndDisplayItems();
                    });
                });

                // Search box
                document.getElementById('searchBox').addEventListener('input', (e) => {
                    this.filterAndDisplayItems(e.target.value);
                });
            }

            async loadData() {
                try {
                    this.updateSyncStatus('Syncing with GitHub...');
                    
                    // Load different types of content
                    const [bugs, ideas, features] = await Promise.all([
                        this.loadBugItems(),
                        this.loadIdeaItems(),
                        this.loadFeatureItems()
                    ]);

                    this.allItems = [...bugs, ...ideas, ...features];
                    this.filterAndDisplayItems();
                    
                    this.updateSyncStatus('✅ Synced successfully');
                    
                } catch (error) {
                    console.error('Error loading data:', error);
                    this.showError('Failed to load data from GitHub. Please check the repository configuration.');
                    this.updateSyncStatus('❌ Sync failed');
                }
            }


            async loadBugItems() {
                const items = [];
                
                try {
                    // Check for bug reports in various locations
                    const bugFiles = [
                        'docs/bugs.md',
                        '.claude/bugs.md',
                        'BUGS.md',
                        'bug-reports.md'
                    ];

                    for (const file of bugFiles) {
                        try {
                            const content = await this.fetchMarkdownContent(file);
                            if (content) {
                                items.push(...this.parseMarkdownItems(content, 'bug', 'general'));
                            }
                        } catch (e) {
                            // File doesn't exist, continue
                        }
                    }
                    
                } catch (error) {
                    console.warn('Error loading bug items:', error);
                }
                
                return items;
            }

            async loadIdeaItems() {
                const items = [];
                
                try {
                    // Load ideas from various sources
                    const ideaFiles = [
                        'docs/ideas.md',
                        '.claude/ideas.md',
                        'IDEAS.md',
                        'feature-ideas.md'
                    ];

                    for (const file of ideaFiles) {
                        try {
                            const content = await this.fetchMarkdownContent(file);
                            if (content) {
                                items.push(...this.parseMarkdownItems(content, 'idea', 'general'));
                            }
                        } catch (e) {
                            // File doesn't exist, continue
                        }
                    }
                    
                } catch (error) {
                    console.warn('Error loading idea items:', error);
                }
                
                return items;
            }

            async loadFeatureItems() {
                const items = [];
                
                try {
                    // Simple list of feature files to load
                    const featureFiles = [
                        'FEATURES.md',
                        '.claude/platforms/mobile-app/features/smartwatch-integration-tickets.md'
                        // Add more feature files here, but exclude roadmap.md
                    ];
                    
                    for (const file of featureFiles) {
                        try {
                            const content = await this.fetchMarkdownContent(file);
                            if (content) {
                                const platform = file.includes('mobile-app') ? 'mobile' : 
                                               file.includes('admin-panel') ? 'admin' : 'general';
                                
                                // Use simple PRD parsing for all feature files
                                const item = this.parsePRDContent(content, file, platform);
                                items.push(item);
                            }
                        } catch (e) {
                            console.log(`Could not load feature file: ${file}`);
                        }
                    }
                    
                } catch (error) {
                    console.error('Error loading feature items:', error);
                }
                
                return items;
            }

            async fetchMarkdownContent(filePath) {
                let url;
                
                if (this.isLocal) {
                    // Local file path - remove leading ./ if present
                    const cleanPath = filePath.startsWith('./') ? filePath.substring(2) : filePath;
                    url = `./${cleanPath}`;
                } else {
                    // GitHub raw content URL
                    url = `${this.rawBase}/${filePath}`;
                }
                
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`Failed to fetch ${filePath} from ${this.isLocal ? 'local' : 'GitHub'}`);
                }
                return await response.text();
            }

            parseMarkdownItems(content, type, platform) {

                const items = [];
                const lines = content.split('\n');
                let currentItem = null;
                let inCodeBlock = false;

                for (const line of lines) {
                    // Track code blocks to avoid parsing headers inside them
                    if (line.trim().startsWith('```')) {
                        inCodeBlock = !inCodeBlock;
                    }

                    // Look for headers as item titles (but not in code blocks)
                    if (!inCodeBlock && (line.startsWith('# ') || line.startsWith('## ') || line.startsWith('### '))) {
                        // Save previous item if it exists
                        if (currentItem && this.isValidItem(currentItem, type)) {
                            items.push(currentItem);
                        }
                        
                        const title = line.replace(/^#+\s*/, '').trim();
                        
                        // Skip non-issue headers based on type
                        if (!this.shouldIncludeHeader(title, type)) {
                            currentItem = null;
                            continue;
                        }

                        currentItem = {
                            id: Date.now() + Math.random(),
                            title: title,
                            description: '',
                            type,
                            platform: this.extractPlatform(line, platform),
                            priority: this.extractPriority(line + content),
                            tags: this.extractTags(line),
                            content: line
                        };
                    } else if (currentItem && line.trim()) {
                        // Add content to current item
                        currentItem.description += line + ' ';
                        currentItem.content += '\n' + line;
                    }
                }

                // Add final item if valid
                if (currentItem && this.isValidItem(currentItem, type)) {
                    items.push(currentItem);
                }

                // Create summaries and preserve full content
                items.forEach(item => {
                    item.summary = this.createSummary(item.description, item.title);
                    // Keep full content for modal
                });

                return items;
            }


            extractField(content, startMarker, endMarker) {
                const lines = content.split('\n');
                let capturing = false;
                let result = [];

                for (const line of lines) {
                    if (line.includes(`**${startMarker}**`) || line.includes(`**${startMarker}:`)) {
                        capturing = true;
                        // Get text after the marker on same line
                        const afterMarker = line.split(`**${startMarker}**`)[1] || line.split(`**${startMarker}:`)[1];
                        if (afterMarker && afterMarker.trim()) {
                            result.push(afterMarker.trim());
                        }
                        continue;
                    }
                    
                    if (capturing) {
                        if (endMarker && (line.includes(`**${endMarker}**`) || line.includes(`**${endMarker}:`))) {
                            break;
                        }
                        if (line.trim()) {
                            result.push(line.trim());
                        }
                    }
                }

                return result.join(' ').trim();
            }

            extractStoryPoints(content) {
                const match = content.match(/\b([1-9]|1[0-3])\s*(points?|pts?)\b/i);
                return match ? match[1] : null;
            }

            extractComplexity(content) {
                const complexityMatch = content.toLowerCase().match(/\b(xs|small?|medium?|large?|xl)\b/);
                return complexityMatch ? complexityMatch[1].toUpperCase() : null;
            }

            generateChips(item) {
                const chips = [];
                
                // Story points chip
                if (item.storyPoints) {
                    chips.push(`<span class="chip story-points">${item.storyPoints} pts</span>`);
                }
                
                // Complexity chip
                if (item.complexity) {
                    chips.push(`<span class="chip complexity">${item.complexity}</span>`);
                }
                
                // Impact chip (for backlog items)
                if (item.type === 'backlog' && item.impact) {
                    const impactLevel = this.extractImpactLevel(item.impact);
                    if (impactLevel) {
                        chips.push(`<span class="chip impact">${impactLevel} impact</span>`);
                    }
                }
                
                // Effort chip (for backlog items)
                if (item.type === 'backlog' && item.effort) {
                    const effortLevel = this.extractEffortLevel(item.effort);
                    if (effortLevel) {
                        chips.push(`<span class="chip effort">${effortLevel} effort</span>`);
                    }
                }
                
                return chips.join('');
            }
            
            extractImpactLevel(impact) {
                const lower = impact.toLowerCase();
                if (lower.includes('high') || lower.includes('critical') || lower.includes('major')) return 'High';
                if (lower.includes('medium') || lower.includes('moderate')) return 'Med';
                if (lower.includes('low') || lower.includes('minor') || lower.includes('small')) return 'Low';
                return null;
            }
            
            extractEffortLevel(effort) {
                const lower = effort.toLowerCase();
                if (lower.includes('high') || lower.includes('large') || lower.includes('complex')) return 'High';
                if (lower.includes('medium') || lower.includes('moderate')) return 'Med';
                if (lower.includes('low') || lower.includes('small') || lower.includes('simple')) return 'Low';
                return null;
            }

            shouldIncludeHeader(title, type) {
                const lowerTitle = title.toLowerCase();
                
                // For ideas and features, be more inclusive
                if (type === 'idea' || type === 'feature') {
                    // Skip only major section headers
                    const skipHeaders = [
                        'ideas & concept pipeline',
                        'features in development',
                        'technical architecture',
                        'overview',
                        'introduction',
                        'conclusion',
                        'background'
                    ];
                    return !skipHeaders.some(skip => lowerTitle.includes(skip));
                }
                
                // For bugs and other types, skip generic headers
                const skipHeaders = [
                    'bug reports & issues',
                    'critical issues',
                    'high priority issues',
                    'medium priority issues',
                    'low priority issues',
                    'backlog',
                    'ready backlog',
                    'technical architecture',
                    'overview',
                    'background',
                    'introduction',
                    'summary',
                    'conclusion',
                    'next steps',
                    'implementation',
                    'requirements'
                ];
                
                return !skipHeaders.some(skip => lowerTitle.includes(skip));
            }

            isValidItem(item, type) {
                // Must have meaningful content
                if (!item.description.trim() || item.description.trim().length < 20) {
                    return false;
                }
                
                // For bugs, must indicate it's a problem/issue
                if (type === 'bug') {
                    const desc = item.description.toLowerCase();
                    return desc.includes('issue') || desc.includes('problem') || desc.includes('bug') || 
                           desc.includes('error') || desc.includes('fail') || desc.includes('not work');
                }
                
                
                return true;
            }

            extractPlatform(line, defaultPlatform) {
                const lowerLine = line.toLowerCase();
                if (lowerLine.includes('mobile') || lowerLine.includes('app')) return 'mobile';
                if (lowerLine.includes('admin') || lowerLine.includes('panel')) return 'admin';
                if (lowerLine.includes('web') || lowerLine.includes('website')) return 'web';
                return defaultPlatform;
            }

            createSummary(description, title) {
                // Extract first meaningful sentence or two
                let text = description
                    .replace(/\*\*(.*?)\*\*/g, '$1')  // Remove bold
                    .replace(/\*(.*?)\*/g, '$1')      // Remove italics
                    .replace(/\[(.*?)\]\(.*?\)/g, '$1') // Remove links, keep text
                    .replace(/`(.*?)`/g, '$1')        // Remove inline code
                    .replace(/^-\s+/gm, '')           // Remove list bullets
                    .replace(/\n+/g, ' ')             // Replace newlines with spaces
                    .trim();
                
                // Find first 1-2 sentences
                const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 10);
                let summary = sentences.slice(0, 2).join('. ').trim();
                
                // If too long, truncate to first sentence
                if (summary.length > 100) {
                    summary = sentences[0].trim();
                }
                
                // Final length check
                if (summary.length > 80) {
                    summary = summary.substring(0, 77) + '...';
                } else if (summary && !summary.endsWith('.') && !summary.endsWith('!') && !summary.endsWith('?')) {
                    summary += '.';
                }
                
                return summary || 'No summary available.';
            }

            extractPriority(text) {
                const lowerText = text.toLowerCase();
                if (lowerText.includes('critical')) {
                    return 'critical';
                } else if (lowerText.includes('high') || lowerText.includes('urgent')) {
                    return 'high';
                } else if (lowerText.includes('medium') || lowerText.includes('moderate')) {
                    return 'medium';
                } else if (lowerText.includes('low') || lowerText.includes('nice')) {
                    return 'low';
                }
                return 'medium';
            }

            extractTags(text) {
                const tags = [];
                const lowerText = text.toLowerCase();
                
                if (lowerText.includes('mobile')) tags.push('mobile');
                if (lowerText.includes('admin')) tags.push('admin');
                if (lowerText.includes('web')) tags.push('web');
                if (lowerText.includes('api')) tags.push('api');
                if (lowerText.includes('ui')) tags.push('ui');
                if (lowerText.includes('backend')) tags.push('backend');
                
                return tags;
            }

            filterAndDisplayItems(searchTerm = '') {
                // Filter by platform
                this.filteredItems = this.currentFilter === 'all' ? 
                    [...this.allItems] : 
                    this.allItems.filter(item => {
                        return item.platform === this.currentFilter;
                    });

                // Filter by search term
                if (searchTerm) {
                    const term = searchTerm.toLowerCase();
                    this.filteredItems = this.filteredItems.filter(item =>
                        item.title.toLowerCase().includes(term) ||
                        item.description.toLowerCase().includes(term) ||
                        item.type.toLowerCase().includes(term) ||
                        item.tags.some(tag => tag.toLowerCase().includes(term))
                    );
                }

                this.displayItems();
            }

            displayItems() {
                const bugItems = this.filteredItems.filter(item => item.type === 'bug');
                const ideaItems = this.filteredItems.filter(item => item.type === 'idea');
                const featureItems = this.filteredItems.filter(item => item.type === 'feature');

                this.renderSection('bugItems', bugItems, 'bugsCount');
                this.renderSection('ideaItems', ideaItems, 'ideasCount');
                this.renderSection('featureItems', featureItems, 'featuresCount');
            }

            renderSection(containerId, items, countId) {
                const container = document.getElementById(containerId);
                const countElement = document.getElementById(countId);
                
                // Store items data globally for the simple display function
                if (containerId === 'bugItems') window.currentBugItems = items;
                else if (containerId === 'ideaItems') window.currentIdeaItems = items;
                else if (containerId === 'featureItems') window.currentFeatureItems = items;
                
                countElement.textContent = items.length;

                if (items.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">📭</div>
                            <div>No items found</div>
                        </div>
                    `;
                    return;
                }

                const html = items.map((item, index) => {
                    const itemId = `${item.type.toUpperCase()}-${String(index + 1).padStart(3, '0')}`;
                    return `
                        <div class="item" data-type="${item.type}" data-platform="${item.platform}" onclick="openItemModal('${itemId}', ${JSON.stringify(item).replace(/"/g, '&quot;')})">
                            <div class="item-header">
                                <div class="item-title">${item.title}</div>
                                <div class="item-priority ${item.priority.toLowerCase()}">${item.priority}</div>
                            </div>
                            <div class="item-summary">${item.summary}</div>
                            <div class="item-footer">
                                <div class="item-platform">${item.platform.charAt(0).toUpperCase() + item.platform.slice(1)}</div>
                                <div class="item-id">#${itemId}</div>
                            </div>
                        </div>
                    `;
                }).join('');

                container.innerHTML = html;
            }

            updateSyncStatus(message = null) {
                const syncElement = document.getElementById('lastSync');
                const repoElement = document.getElementById('repoStatus');
                
                if (message) {
                    syncElement.textContent = message;
                } else {
                    const timeStr = new Date().toLocaleTimeString();
                    const sourceStr = this.isLocal ? 'local files' : 'GitHub';
                    syncElement.textContent = `Last sync: ${timeStr} (${sourceStr})`;
                }
                
                const locationStr = this.isLocal ? 'Local Development' : `${this.repoOwner}/${this.repoName}`;
                repoElement.textContent = `Source: ${locationStr}`;
            }

            async loadPRDItems() {
                const items = [];
                
                try {
                    // Scan for PRD files in the docs/prds directory
                    const prdPaths = [
                        'docs/prds/mobile-app/workout-tracking-prd.md',
                        'docs/prds/admin-panel/operator-efficiency-prd.md',
                        'docs/prds/general/subscription-management-prd.md'
                    ];

                    for (const prdPath of prdPaths) {
                        try {
                            const content = await this.fetchMarkdownContent(prdPath);
                            if (content) {
                                const prdItem = this.parsePRDContent(content, prdPath);
                                if (prdItem) {
                                    items.push(prdItem);
                                }
                            }
                        } catch (e) {
                            // File doesn't exist, continue
                        }
                    }
                    
                } catch (error) {
                    console.warn('Error loading PRD items:', error);
                }
                
                return items;
            }

            parsePRDContent(content, filePath, platform) {
                const lines = content.split('\n');
                const title = this.extractPRDTitle(lines);
                const summary = this.extractPRDSummary(content);
                const status = this.extractPRDStatus(content);
                const lastUpdated = this.extractLastUpdated(content);
                
                return {
                    id: Date.now() + Math.random(),
                    title: title || this.generateTitleFromPath(filePath),
                    type: 'feature',
                    platform: platform || this.determinePlatform(filePath),
                    priority: 'medium',
                    summary: summary,
                    description: summary,
                    content: content,
                    filePath: filePath,
                    status: status,
                    lastUpdated: lastUpdated
                };
            }

            extractPRDTitle(lines) {
                for (const line of lines) {
                    if (line.startsWith('# ')) {
                        return line.replace(/^#\s*/, '').trim();
                    }
                }
                return null;
            }

            parseTicketItems(content, filePath, platform) {
                const items = [];
                
                // Split content into sections based on ## and ### headers
                const sections = content.split(/(?=^##|^###)/m);
                
                for (let i = 0; i < sections.length; i++) {
                    const section = sections[i].trim();
                    if (!section) continue;
                    
                    // Epic sections (## Epic)
                    if (section.startsWith('## Epic')) {
                        const titleMatch = section.match(/^## (Epic \d+: .+?)(?:\n|$)/);
                        const title = titleMatch ? titleMatch[1] : 'Epic';
                        
                        const businessOutcomeMatch = section.match(/\*\*Business Outcome\*\*:\s*(.+?)(?:\n|$)/);
                        const summary = businessOutcomeMatch ? businessOutcomeMatch[1] : '';
                        
                        items.push({
                            id: `epic-${i}-${Date.now()}`,
                            title: title,
                            type: 'epic',
                            platform: platform,
                            content: section,
                            summary: summary,
                            status: 'pending',
                            priority: 'high',
                            filePath: filePath,
                            isDevelopmentTickets: true
                        });
                    }
                    
                    // Story sections (### Story)
                    else if (section.startsWith('### Story')) {
                        const titleMatch = section.match(/^### (Story \d+: .+?)(?:\n|$)/);
                        const title = titleMatch ? titleMatch[1] : 'Story';
                        
                        const customerMatch = section.match(/\*\*Customer Job\*\*:\s*(.+?)(?:\n|$)/);
                        const summary = customerMatch ? customerMatch[1] : title.replace(/^Story \d+: /, '');
                        
                        items.push({
                            id: `story-${i}-${Date.now()}`,
                            title: title,
                            type: 'story',
                            platform: platform,
                            content: section,
                            summary: summary,
                            status: 'pending',
                            priority: 'medium',
                            filePath: filePath,
                            isDevelopmentTickets: true
                        });
                    }
                    
                    // Technical Spike sections (### Technical Spike)
                    else if (section.startsWith('### Technical Spike')) {
                        const titleMatch = section.match(/^### (Technical Spike \d+: .+?)(?:\n|$)/);
                        const title = titleMatch ? titleMatch[1] : 'Technical Spike';
                        
                        const questionMatch = section.match(/\*\*Technical Question\*\*:\s*(.+?)(?:\n|$)/);
                        const summary = questionMatch ? questionMatch[1] : title.replace(/^Technical Spike \d+: /, '');
                        
                        items.push({
                            id: `spike-${i}-${Date.now()}`,
                            title: title,
                            type: 'spike',
                            platform: platform,
                            content: section,
                            summary: summary,
                            status: 'pending',
                            priority: 'high',
                            filePath: filePath,
                            isDevelopmentTickets: true
                        });
                    }
                }
                
                console.log(`Parsed ${items.length} items from ${filePath}`);
                return items;
            }

            extractPRDSummary(content) {
                // Look for summary, overview, or description section
                const summaryMatch = content.match(/##\s*(Summary|Overview|Description)\s*\n([\s\S]*?)(?=##|$)/i);
                if (summaryMatch) {
                    const summary = summaryMatch[2].trim().split('\n')[0];
                    return summary.length > 120 ? summary.substring(0, 120) + '...' : summary;
                }
                
                // Look for Business Outcome or Problem Statement for ticket files
                const businessOutcomeMatch = content.match(/\*\*Business Outcome\*\*:\s*(.*?)(?:\n|$)/);
                if (businessOutcomeMatch) {
                    const outcome = businessOutcomeMatch[1].trim();
                    return outcome.length > 120 ? outcome.substring(0, 120) + '...' : outcome;
                }
                
                // Look for Epic descriptions
                const epicMatch = content.match(/##\s*Epic\s*\d+:\s*(.*?)(?:\n|$)/);
                if (epicMatch) {
                    const epic = epicMatch[1].trim();
                    return epic.length > 120 ? epic.substring(0, 120) + '...' : epic;
                }
                
                // Fallback: get first paragraph after title and metadata
                const lines = content.split('\n');
                let foundTitle = false;
                let skipMetadata = false;
                
                for (const line of lines) {
                    if (line.startsWith('# ')) {
                        foundTitle = true;
                        continue;
                    }
                    
                    // Skip metadata line that starts with *
                    if (foundTitle && line.trim().startsWith('*') && line.trim().endsWith('*')) {
                        skipMetadata = true;
                        continue;
                    }
                    
                    // Find first substantial content line
                    if (foundTitle && line.trim() && !line.startsWith('#') && !line.trim().startsWith('*')) {
                        const summary = line.trim().replace(/\*\*/g, ''); // Remove bold formatting
                        return summary.length > 120 ? summary.substring(0, 120) + '...' : summary;
                    }
                }
                
                return 'Development tickets and feature breakdown';
            }

            determinePlatform(filePath) {
                if (filePath.includes('mobile-app')) return 'mobile';
                if (filePath.includes('admin-panel')) return 'admin';
                if (filePath.includes('web')) return 'web';
                return 'general';
            }

            extractPRDStatus(content) {
                const statusMatch = content.match(/\*\*Status\*\*:?\s*(Draft|Review|Approved|In Development|Complete)/i);
                return statusMatch ? statusMatch[1].toLowerCase() : 'draft';
            }

            extractLastUpdated(content) {
                const dateMatch = content.match(/\*\*Last Updated\*\*:?\s*([\d\/\-\.]+)/i) || 
                                content.match(/Updated:?\s*([\d\/\-\.]+)/i);
                return dateMatch ? dateMatch[1] : null;
            }

            generateTitleFromPath(filePath) {
                const fileName = filePath.split('/').pop().replace('.md', '');
                return fileName.split('-').map(word => 
                    word.charAt(0).toUpperCase() + word.slice(1)
                ).join(' ');
            }

            showError(message) {
                const sections = ['bugItems', 'ideaItems', 'featureItems'];
                sections.forEach(sectionId => {
                    document.getElementById(sectionId).innerHTML = `<div class="error">${message}</div>`;
                });
            }
        }

        // Modal functionality
        function openItemModal(itemId, item) {
            // Populate modal header
            document.getElementById('modalIssueId').textContent = `#${itemId}`;
            document.getElementById('modalTitle').textContent = item.title;
            document.getElementById('modalPriority').textContent = item.priority;
            document.getElementById('modalPriority').className = `modal-priority ${item.priority.toLowerCase()}`;
            document.getElementById('modalPlatform').textContent = item.platform.charAt(0).toUpperCase() + item.platform.slice(1);
            
            // Generate content based on item type
            const content = generateModalContent(item);
            document.getElementById('modalContent').innerHTML = content;
            
            // Show modal
            document.getElementById('itemModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('itemModal').classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        function generateModalContent(item) {
            // Create consistent layout for all item types
            let content = '';
            
            // Summary section
            content += `
                <div class="modal-section">
                    <div class="modal-section-header">
                        📝 Summary
                    </div>
                    <div class="modal-section-content">
                        ${item.summary || item.description || 'No summary available.'}
                    </div>
                </div>
            `;

            // Main content section
            content += `
                <div class="modal-section">
                    <div class="modal-section-header">
                        📄 ${item.type === 'feature' ? 'Feature Details' : item.type === 'bug' ? 'Bug Details' : 'Description'}
                    </div>
                    <div class="modal-section-content">
                        ${parseAndFormatContent(item.content, item.type)}
                    </div>
                </div>
            `;

            // Type-specific sections
            if (item.type === 'feature') {
                content += generateFeatureSpecificSections(item);
            } else if (item.type === 'bug') {
                content += generateBugSpecificSections(item);
            } else if (item.type === 'idea') {
                content += generateIdeaSpecificSections(item);
            }

            return content;
        }

        function parseAndFormatContent(content, type) {
            if (!content) return 'No content available.';
            
            // Convert markdown-like formatting to HTML
            let formatted = content
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')  // Bold
                .replace(/\*(.*?)\*/g, '<em>$1</em>')              // Italic
                .replace(/### (.*$)/gm, '<h4>$1</h4>')             // H4 headers
                .replace(/## (.*$)/gm, '<h3>$1</h3>')              // H3 headers
                .replace(/# (.*$)/gm, '<h2>$1</h2>')               // H2 headers
                .replace(/\n- /g, '\n• ')                          // Bullet points
                .replace(/\n/g, '<br>')                            // Line breaks
                .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank">$1</a>'); // Links
            
            return `<div class="formatted-content">${formatted}</div>`;
        }

        function generateFeatureSpecificSections(item) {
            let content = '';
            
            // Look for common feature patterns in content
            if (item.content && item.content.includes('Epic')) {
                content += `
                    <div class="modal-section">
                        <div class="modal-section-header">
                            📦 Development Structure
                        </div>
                        <div class="modal-section-content">
                            <div class="feature-info">
                                This feature includes epics, user stories, and implementation details.
                                <br><br>
                                <strong>Platform:</strong> ${item.platform}<br>
                                <strong>Type:</strong> Feature Development
                            </div>
                        </div>
                    </div>
                `;
            }

            return content;
        }

        function generateBugSpecificSections(item) {
            return `
                <div class="modal-section">
                    <div class="modal-section-header">
                        🐛 Bug Information
                    </div>
                    <div class="modal-section-content">
                        <div class="bug-info">
                            <strong>Platform:</strong> ${item.platform}<br>
                            <strong>Priority:</strong> ${item.priority}<br>
                            <strong>Status:</strong> Reported
                        </div>
                    </div>
                </div>
            `;
        }

        function generateIdeaSpecificSections(item) {
            return `
                <div class="modal-section">
                    <div class="modal-section-header">
                        💡 Idea Information
                    </div>
                    <div class="modal-section-content">
                        <div class="idea-info">
                            <strong>Platform:</strong> ${item.platform}<br>
                            <strong>Stage:</strong> Concept<br>
                            <strong>Status:</strong> Under Review
                        </div>
                    </div>
                </div>
            `;
        }

        // Clean and simple - no more broken modal functions!

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new PMDashboard();
        });
    </script>
</body>
</html>
